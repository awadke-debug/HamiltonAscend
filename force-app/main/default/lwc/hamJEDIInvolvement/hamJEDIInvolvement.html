<template>
    <div class="backgroundWhite">
        <lightning-accordion allow-multiple-sections-open="true" active-section-name={activeSection} onsectiontoggle={handleSectionToggle}>
            <lightning-accordion-section name={tableTitle} label={tableTitle}>
                <template if:true={loading}>
                    <lightning-spinner
                        alternative-text="Loading..."
                        size="medium"
                        variant="brand">
                    </lightning-spinner>
                </template>
                <template lwc:if={pageInvolvements.length}>
                    <!-- Involvement Records Table -->
                    <div class="slds-p-around_small" style="width: 100%;">
                        <div style="overflow-x: auto;">
                            <lightning-datatable
                                key-field="Id"
                                data={pageInvolvements}
                                columns={displayColumns}
                                hide-checkbox-column
                                sorted-by={sortedBy}
                                sorted-direction={sortedDirection}
                                onsort={handleSort}>
                            </lightning-datatable>
                        </div>

                        <!-- Pagination Controls -->
                        <template if:true={showPagination}>
                            <div class="slds-m-top_small slds-grid slds-grid_align-spread slds-align_absolute-center">
                                <lightning-button label="Prev" onclick={prevPage} disabled={isFirstPage}></lightning-button>
                                <div class="slds-m-horizontal_small">
                                    Page {pageNumber} of {totalPages} Â· {totalRecords} total
                                </div>
                                <lightning-button label="Next" onclick={nextPage} disabled={isLastPage}></lightning-button>
                            </div>
                        </template>
                    </div>
                </template>
                <template lwc:else>
                    <div class="slds-p-around_medium slds-text-align_center">
                        No Involvement Value found
                    </div>
                </template>
            </lightning-accordion-section>
        </lightning-accordion>
    </div>
</template>