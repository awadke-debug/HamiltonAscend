<template>
    <div class="backgroundWhite">
       <lightning-accordion allow-multiple-sections-open="true" active-section-name={activeBalanceSection} onsectiontoggle={handleBalanceSectionToggle}>
            <lightning-accordion-section name={accordianName} label={accordianName}>
                <template if:true={loading}>
                    <lightning-spinner
                        alternative-text="Loading..."
                        size="medium"
                        variant="brand">
                    </lightning-spinner>
                </template>
                <template lwc:if={pageBalance}>
                    <!-- Balance Record Table -->
                    <div class="slds-p-around_small" style="width: 100%;">
                        <div class="label slds-text-title_caps slds-text-color_brand">{accordianName}</div>
                        <div style="overflow-x: auto;">
                            <lightning-datatable
                                key-field="Id" 
                                data={pageBalance} 
                                columns={displayColumns} 
                                hide-checkbox-column
                                sorted-by={sortedBy}
                                sorted-direction={sortedDirection}
                                onsort={handleEventSort}>
                            </lightning-datatable>
                        </div>
                        
                        <!-- Pagination Controls (only show if more than 10 records) -->
                        <template if:true={showPagination}>
                            <div class="slds-m-top_small slds-grid slds-grid_align-spread slds-align_absolute-center">
                                <lightning-button label="Prev" onclick={prevPage} disabled={isFirstPage}></lightning-button>
                                <div class="slds-m-horizontal_small">
                                    Page {pageNumber} of {totalPages} Â· {totalRecords} total
                                </div>
                                <lightning-button label="Next" onclick={nextPage} disabled={isLastPage}></lightning-button>
                            </div>
                        </template>
                    </div>
                </template>
                <template lwc:else>No Records Found</template>
            </lightning-accordion-section>
        </lightning-accordion>
    </div>
</template>